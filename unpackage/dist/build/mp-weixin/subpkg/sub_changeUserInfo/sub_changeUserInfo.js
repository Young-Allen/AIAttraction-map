(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subpkg/sub_changeUserInfo/sub_changeUserInfo"],{"0960":function(e,t,n){"use strict";var a=n("9568"),o=n.n(a);o.a},2687:function(e,t,n){"use strict";(function(e){var a=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("2eee")),i=a(n("c973")),r=a(n("9523")),s=a(n("1253")),u=n("26cb");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={components:{dragBall:function(){Promise.all([n.e("common/vendor"),n.e("components/drag-ball/drag-ball")]).then(function(){return resolve(n("8866"))}.bind(null,n)).catch(n.oe)}},computed:l({},(0,u.mapState)("m_user",["token","userinfo","userPosition"])),data:function(){return{interestsTags:[{x:79.45049232358554,y:123.96125634387865,radius:56,color:["#787878","#25AEBF"],colse:!1,size:"15",floating:[0,!1],labelName:"山川美景"},{x:198.76606872737423,y:79.28588367513791,radius:54,color:["#787878","#25AEBF"],colse:!1,size:"15",floating:[5,!1],labelName:"文物古迹"},{x:290.5796037054993,y:108.66399668264214,radius:60,color:["#787878","#25AEBF"],colse:!1,size:"15",floating:[7,!0],labelName:"放松身心"},{x:152.08387466634375,y:132.84566053159986,radius:50,color:["#787878","#25AEBF"],colse:!1,size:"15",floating:[5,!1],labelName:"温泉度假"},{x:287.6493903164786,y:188.97865661799298,radius:46,color:["#787878","#25AEBF"],colse:!1,size:"15",floating:[5,!1],labelName:"工作出行"},{x:107.73067038886846,y:187.2797271941687,radius:44,color:["#787878","#25AEBF"],colse:!1,size:"15",floating:[5,!1],labelName:"亲友伴游"},{x:40,y:205.77712553537478,radius:42,color:["#787878","#25AEBF"],colse:!1,size:"15",floating:[5,!1],labelName:"宗教文化"}],colse:!1,curInt:[],tmptags:[],position:"",value:"请填写",sex:[{id:1,name:"男"},{id:2,name:"女"}],index:0,date:"请填写",avater:"",url:"",headimg:""}},onLoad:function(e){var t=this,n=this;if(s.default.getAllTags().then((function(e){t.tmptags=e,console.log(t.tmptags),e.forEach((function(e,a){t.$set(n.interestsTags[a],"labelName",e.tagName)}))})),this.getPosition(),void 0!==e.userInfo){var a=JSON.parse(decodeURIComponent(e.userInfo));this.avater=a.avatarUrl,console.log(a)}},methods:l(l({},(0,u.mapMutations)("m_user",["saveUserInfoToStorage","updateUserInfo","updateToken","saveTokenToStorage","updateUserPosition"])),{},{getPosition:function(){var t=this;e.getFuzzyLocation({success:function(e){var n={latitude:e.latitude,longitude:e.longitude};console.log(n),t.position=e.latitude+","+e.longitude,t.updateUserPosition(n)}})},click_:function(t){var n=null,a=t;this.curInt.forEach((function(e,t){e==a&&(n=t)})),null==n?this.curInt.length<=7?this.curInt.push(a):e.showToast({title:"超出可选范围8个",duration:2e3}):this.curInt.splice(n,1)},savaInfo:function(){var t=this;console.log(this.curInt),console.log(this.userPosition);var n=this.headimg,a=this.index,o=this.date,i={};if(this.curInt.length<2)e.showToast({title:"请选择至少两个感兴趣的标签",icon:"none",duration:2e3});else{var r=[];this.curInt.forEach((function(e){var n={id:t.tmptags[e].id,tagName:t.tmptags[e].tagName};r.push(n)})),i.interestTags=r,n||(n=this.avater),i.avatar=n,i.gender=this.sex[a].name,"0000-00-00"!=o?(i.birthday=o,i.address="",this.updata(i)):e.showToast({title:"请选择生日",icon:"none",duration:2e3})}},updata:function(t){var n=this;return(0,i.default)(o.default.mark((function a(){return o.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:console.log(t),s.default.updateUserInfo(t).then((function(t){n.updateUserInfo(t.data),e.switchTab({url:"/pages/my/my"})}));case 2:case"end":return a.stop()}}),a)})))()},isPoneAvailable:function(e){return!!/^[1][3,4,5,7,8][0-9]{9}$/.test(e)},avatarChoose:function(){var t=this;e.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){t.imgUpload(e.tempFilePaths);e.tempFilePaths}})},getUserInfo:function(){e.getUserProfile({desc:"用于完善会员资料",success:function(t){console.log(t),e.showToast({title:"已授权",icon:"none",duration:2e3})}})},imgUpload:function(t){var n=this;e.uploadFile({header:{Authorization:e.getStorageSync("token")},url:"/api/upload/image",filePath:t[0],name:"file",formData:{type:"user_headimg"},success:function(e){var t=JSON.parse(e.data);t=t.data,n.avater=n.url+t.img,n.headimg=n.url+t.img},fail:function(e){console.log(e)}})},bindPickerChange:function(e){this.index=e.detail.value},bindDateChange:function(e){this.date=e.detail.value}})};t.default=f}).call(this,n("543d")["default"])},"3f3b":function(e,t,n){"use strict";(function(e,t){var a=n("4ea4");n("beb8");a(n("66fd"));var o=a(n("b7d7"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},9568:function(e,t,n){},9741:function(e,t,n){"use strict";n.r(t);var a=n("2687"),o=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=o.a},b34f:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){}));var a=function(){var e=this.$createElement;this._self._c},o=[]},b7d7:function(e,t,n){"use strict";n.r(t);var a=n("b34f"),o=n("9741");for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);n("0960");var r=n("f0c5"),s=Object(r["a"])(o["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);t["default"]=s.exports}},[["3f3b","common/runtime","common/vendor"]]]);